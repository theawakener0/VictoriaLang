include "net"

let port = ":9000"

let handler = define(conn) {
    print("New connection from: " + conn.remoteAddr())
    conn.write("Welcome to Victoria TCP Server!\n")
    
    while (true) {
        let data = conn.read(1024)
        if (data == "") {
            print("Connection closed by client")
            break
        }
        print("Received: " + data)
        conn.write("Echo: " + data)
    }
}

net.listenTcp(port, handler)
